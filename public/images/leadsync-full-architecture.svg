<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 960 500" font-family="Inter, system-ui, -apple-system, sans-serif">
  <defs>
    <style>
      .title { font-size: 16px; fill: #0f172a; font-weight: 700; }
      .subtitle { font-size: 11px; fill: #94a3b8; }
      .section-title { font-size: 12px; fill: #0f172a; font-weight: 700; letter-spacing: 0.5px; }
      .section-sub { font-size: 10px; fill: #94a3b8; }
      .node-rect { rx: 8; ry: 8; stroke-width: 1.5; }
      .node-file { font-size: 11px; font-weight: 600; }
      .node-func { font-size: 9px; fill: #64748b; }
      .node-label { font-size: 10px; font-weight: 600; }
      .entry-file { font-size: 11px; fill: #ffffff; font-weight: 600; }
      .entry-func { font-size: 9px; fill: #94a3b8; }
      .edge { stroke: #94a3b8; stroke-width: 1.5; fill: none; }
      .edge-yes { stroke: #10b981; stroke-width: 1.5; fill: none; }
      .edge-no { stroke: #ef4444; stroke-width: 1.5; fill: none; stroke-dasharray: 4,3; }
      .diamond-text { font-size: 9px; fill: #92400e; font-weight: 700; }
      .yes-label { font-size: 9px; fill: #059669; font-weight: 700; }
      .no-label { font-size: 9px; fill: #dc2626; font-weight: 600; }
      .sep { stroke: #e2e8f0; stroke-width: 1; stroke-dasharray: 6,4; }
      .note { font-size: 9px; fill: #94a3b8; font-style: italic; }
      .legend-label { font-size: 10px; fill: #64748b; }
    </style>
  </defs>

  <!-- Background -->
  <rect width="960" height="500" fill="#fafbfc" rx="8"/>

  <!-- Title -->
  <text x="480" y="28" text-anchor="middle" class="title">LeadSync Architecture</text>
  <text x="480" y="44" text-anchor="middle" class="subtitle">Two flows: instant webhook response + hourly nurture cron. All file names labeled.</text>


  <!-- ==================== WEBHOOK FLOW ==================== -->

  <text x="30" y="72" class="section-title">WEBHOOK FLOW</text>
  <text x="30" y="86" class="section-sub">Runs on every form submission</text>

  <!-- Node 1: Tally Form (external input — gray) -->
  <rect x="30" y="175" width="110" height="34" class="node-rect" fill="#f8fafc" stroke="#94a3b8"/>
  <text x="85" y="196" text-anchor="middle" class="node-label" fill="#475569">Tally Form</text>

  <!-- Arrow 1→2 -->
  <line x1="140" y1="192" x2="165" y2="192" class="edge"/>

  <!-- Node 2: app.py webhook_handler (entry point — dark) -->
  <rect x="165" y="168" width="150" height="48" class="node-rect" fill="#0f172a" stroke="#0f172a"/>
  <text x="240" y="189" text-anchor="middle" class="entry-file">app.py</text>
  <text x="240" y="204" text-anchor="middle" class="entry-func">webhook_handler()</text>

  <!-- Arrow 2→3 -->
  <line x1="315" y1="192" x2="345" y2="192" class="edge"/>

  <!-- Node 3: handlers.py process_new_lead (code — indigo) -->
  <rect x="345" y="168" width="165" height="48" class="node-rect" fill="#eef2ff" stroke="#6366f1"/>
  <text x="427" y="189" text-anchor="middle" class="node-file" fill="#4f46e5">handlers.py</text>
  <text x="427" y="204" text-anchor="middle" class="node-func">process_new_lead()</text>

  <!-- Split lines from process_new_lead to 3 parallel paths -->
  <path d="M 510,180 L 550,138" class="edge"/>
  <line x1="510" y1="192" x2="550" y2="192" class="edge"/>
  <path d="M 510,204 L 550,246" class="edge"/>

  <!-- Path 1 (top): sheets.py → Google Sheet -->
  <rect x="550" y="118" width="155" height="40" class="node-rect" fill="#eef2ff" stroke="#6366f1"/>
  <text x="627" y="136" text-anchor="middle" class="node-file" fill="#4f46e5">sheets.py</text>
  <text x="627" y="150" text-anchor="middle" class="node-func">log_lead()</text>

  <line x1="705" y1="138" x2="735" y2="138" class="edge"/>

  <rect x="735" y="121" width="125" height="34" class="node-rect" fill="#ecfdf5" stroke="#10b981"/>
  <text x="797" y="142" text-anchor="middle" class="node-label" fill="#059669">Google Sheet</text>

  <!-- Path 2 (mid): emails.py → Lead Inbox -->
  <rect x="550" y="172" width="155" height="40" class="node-rect" fill="#eef2ff" stroke="#6366f1"/>
  <text x="627" y="190" text-anchor="middle" class="node-file" fill="#4f46e5">emails.py</text>
  <text x="627" y="204" text-anchor="middle" class="node-func">send_confirmation()</text>

  <line x1="705" y1="192" x2="735" y2="192" class="edge"/>

  <rect x="735" y="175" width="125" height="34" class="node-rect" fill="#ecfdf5" stroke="#10b981"/>
  <text x="797" y="196" text-anchor="middle" class="node-label" fill="#059669">Lead Inbox</text>

  <!-- Path 3 (bottom): emails.py → Collin Inbox -->
  <rect x="550" y="226" width="155" height="40" class="node-rect" fill="#eef2ff" stroke="#6366f1"/>
  <text x="627" y="244" text-anchor="middle" class="node-file" fill="#4f46e5">emails.py</text>
  <text x="627" y="258" text-anchor="middle" class="node-func">send_owner_notif()</text>

  <line x1="705" y1="246" x2="735" y2="246" class="edge"/>

  <rect x="735" y="229" width="125" height="34" class="node-rect" fill="#ecfdf5" stroke="#10b981"/>
  <text x="797" y="250" text-anchor="middle" class="node-label" fill="#059669">Collin Inbox</text>


  <!-- ==================== SEPARATOR ==================== -->

  <line x1="30" y1="290" x2="930" y2="290" class="sep"/>


  <!-- ==================== CRON FLOW ==================== -->

  <text x="30" y="316" class="section-title">CRON FLOW</text>
  <text x="30" y="330" class="section-sub">Runs every hour — checks for leads needing nurture</text>

  <!-- Node 1: Modal Cron (entry — dark) -->
  <rect x="30" y="356" width="100" height="40" class="node-rect" fill="#0f172a" stroke="#0f172a"/>
  <text x="80" y="374" text-anchor="middle" class="entry-file">Modal Cron</text>
  <text x="80" y="388" text-anchor="middle" class="entry-func">hourly</text>

  <!-- Arrow -->
  <line x1="130" y1="376" x2="150" y2="376" class="edge"/>

  <!-- Node 2: app.py nurture_check -->
  <rect x="150" y="356" width="120" height="40" class="node-rect" fill="#eef2ff" stroke="#6366f1"/>
  <text x="210" y="374" text-anchor="middle" class="node-file" fill="#4f46e5">app.py</text>
  <text x="210" y="388" text-anchor="middle" class="node-func">nurture_check()</text>

  <!-- Arrow -->
  <line x1="270" y1="376" x2="290" y2="376" class="edge"/>

  <!-- Node 3: handlers.py process_nurture_batch -->
  <rect x="290" y="356" width="140" height="40" class="node-rect" fill="#eef2ff" stroke="#6366f1"/>
  <text x="360" y="374" text-anchor="middle" class="node-file" fill="#4f46e5">handlers.py</text>
  <text x="360" y="388" text-anchor="middle" class="node-func">process_nurture_batch()</text>

  <!-- Arrow -->
  <line x1="430" y1="376" x2="450" y2="376" class="edge"/>

  <!-- Node 4: sheets.py get_nurture_leads -->
  <rect x="450" y="356" width="135" height="40" class="node-rect" fill="#eef2ff" stroke="#6366f1"/>
  <text x="517" y="374" text-anchor="middle" class="node-file" fill="#4f46e5">sheets.py</text>
  <text x="517" y="388" text-anchor="middle" class="node-func">get_nurture_leads()</text>

  <!-- Arrow to diamond -->
  <line x1="585" y1="376" x2="612" y2="376" class="edge"/>

  <!-- Decision Diamond -->
  <polygon points="642,350 672,376 642,402 612,376" fill="#fef3c7" stroke="#f59e0b" stroke-width="1.5"/>
  <text x="642" y="379" text-anchor="middle" class="diamond-text">≥24h?</text>

  <!-- YES path (right) -->
  <line x1="672" y1="376" x2="700" y2="376" class="edge-yes"/>
  <text x="686" y="368" text-anchor="middle" class="yes-label">YES</text>

  <!-- NO path (down) -->
  <line x1="642" y1="402" x2="642" y2="425" class="edge-no"/>
  <text x="660" y="420" class="no-label">skip</text>

  <!-- Node 6: emails.py send_nurture -->
  <rect x="700" y="356" width="115" height="40" class="node-rect" fill="#eef2ff" stroke="#6366f1"/>
  <text x="757" y="374" text-anchor="middle" class="node-file" fill="#4f46e5">emails.py</text>
  <text x="757" y="388" text-anchor="middle" class="node-func">send_nurture()</text>

  <!-- Arrow to output -->
  <line x1="815" y1="376" x2="840" y2="376" class="edge"/>

  <!-- Node 7: Lead Inbox (output — green) -->
  <rect x="840" y="359" width="95" height="34" class="node-rect" fill="#ecfdf5" stroke="#10b981"/>
  <text x="887" y="380" text-anchor="middle" class="node-label" fill="#059669">Lead Inbox</text>

  <!-- Conditions note -->
  <text x="642" y="448" text-anchor="middle" class="note">Full check: ≥24h since signup, nurture_sent=FALSE, manual_outreach=FALSE</text>


  <!-- ==================== LEGEND ==================== -->

  <rect x="30" y="474" width="12" height="12" rx="3" fill="#f8fafc" stroke="#94a3b8" stroke-width="1.5"/>
  <text x="48" y="484" class="legend-label">External Service</text>

  <rect x="175" y="474" width="12" height="12" rx="3" fill="#0f172a" stroke="#0f172a" stroke-width="1.5"/>
  <text x="193" y="484" class="legend-label">Modal Entry Point</text>

  <rect x="335" y="474" width="12" height="12" rx="3" fill="#eef2ff" stroke="#6366f1" stroke-width="1.5"/>
  <text x="353" y="484" class="legend-label">Python Module</text>

  <rect x="470" y="474" width="12" height="12" rx="3" fill="#ecfdf5" stroke="#10b981" stroke-width="1.5"/>
  <text x="488" y="484" class="legend-label">Output / Destination</text>

  <rect x="625" y="474" width="12" height="12" rx="3" fill="#fef3c7" stroke="#f59e0b" stroke-width="1.5"/>
  <text x="643" y="484" class="legend-label">Decision</text>
</svg>